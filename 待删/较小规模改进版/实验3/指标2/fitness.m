function F=fitness(X) 
Index=[4,8,11,15,20,25,27,30,32,35,37,40,44,47,51,55,57,61,64,67,70,74,77,79,83,87,90,93,96];
D=[0,0,0,0,0,0,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];
time=[2,8,7,5,3,5,6,4,4,6,10,7,4,4,6,3,3,6,2,6,5,8,8,8,8,5,8,4,7,4,5,2,3,11,0.000100000000000000,8,8,8,6,7,2,2,3,3,2,2,7,3,...
     11,8,6,8,4,10,9,8,6,9,8,8,10,7,5,0.000100000000000000,3,3,8,9,11,10,6,2,6,0.000100000000000000,9,6,6,3,3,2,10,7,...
     0.000100000000000000,5,1,3,8,8,6,4,8,11,5,2,2,0.000100000000000000,0];
cost=[96;59;85;25;33;72;91;41;16;88;36;77;24;73;86;75;42;75;23;38;48;89;24;89;82;97;43;28;32;85;97;73;53;36;0;88;18;29;85;...
      86;38;35;49;59;19;85;58;80;31;97;78;41;95;73;86;14;15;77;37;57;24;98;55;0;17;53;16;90;50;16;17;58;17;0;49;55;62;66;...
      44;66;24;35;0;24;30;32;53;10;13;52;25;71;82;62;73;0;0];
Performance=[0.231481014964742;2.19710766314825;1.85990156104720;2.98501621100165;0.671090848495166;1.13856448360918;...
             4.07391208263640;1.32162763320107;2.05160102453582;4.67986088247891;1.37776231510427;0.726449794267819;...
             3.51010064665726;2.83533275220637;3.05796917773298;0.210154254967868;2.08633447378613;0.0213321708357972;...
             1.23267734430445;3.53028091792003;0.307703579603499;1.47346749301640;4.94056376406089;4.85611115113488;...
             2.40923194339852;3.67846693264123;3.16327887093069;2.32846535721868;4.28533216320660;0.862591260830895;...
             4.14215961122055;0.210347617291590;4.33476845906399;3.37998293734124;0;3.35785123817139;2.30184251944621;...
             3.90001611189293;0.567220419320587;2.54078714424303;4.35744769971937;4.63764637906011;1.10168165774156;...
             1.25965151277309;4.52006235804494;1.72758669357564;0.284362870243578;3.57443336056016;2.07209429576679;...
             3.67662093747572;2.38545816721685;2.50282777218216;2.08780955204295;1.45242448017576;4.50355433693676;...
             3.34393788992554;3.94416171671484;4.47869765546559;1.25094471194680;4.59910306986211;4.31302543629279;...
             2.53042631062493;2.83951087072015;0;3.81057920278884;0.866125035921618;2.66918020502955;0.632186526143596;...
             0.364585467910786;3.04513721880282;2.45601564807840;3.37404967369636;3.95427091527142;0;0.420403405383407;...
             3.15606056216790;2.88487447690724;3.25321088395852;2.71589727407190;2.78683693765101;4.34277316820244;...
             2.26005808185788;0;3.45481851882633;0.447474956975544;2.15962659443655;0.510671103522442;0.689049464555167;...
             0.0106277923295450;1.04853218080811;1.08318631219117;2.58122240617221;2.85104119245122;4.11980590251624;...
             2.43355594411579;0;0];
m=Index(end);
for i = 1:size(X,1)
    idx = floor(X(i,:));
x = zeros(1,m+1);
temp =[0,4,8,11,15,20,25,27,30,32,35,37,40,44,47,51,55,57,61,64,67,70,74,77,79,83,87,90,93];
 x(idx(idx>0)+temp) = 1;
   if (x(50)~=x(76))&&(x(50)==1)
        x(76)=1;
        x(75)=0;
        x(77)=0;
    elseif (x(50)~=x(76))&&(x(76)==1)
        x(50)=1;
        x(48)=0;
        x(49)=0;
        x(51)=0;
    end
    if (x(11)~=x(73))&&(x(11)==1)
        x(73)=1;
        x(71)=0;
        x(72)=0;
        x(74)=0;
    elseif (x(11)~=x(73))&&(x(73)==1)
        x(11)=1;
        x(9)=0;
        x(10)=0;
    end
    if (x(13)==x(94))&&(x(13)==1)
        x(94)=0;
        x(95)=round(rand(1));
        x(96)=1-x(95);
    elseif (x(13)==x(94))&&(x(13)==0)
        x(94)=1;
        x(95)=0;
        x(96)=0;
    end
    if (x(53)==x(78))&&(x(53)==1)
        x(78)=0;
        x(79)=1;
    elseif (x(53)==x(78))&&(x(53)==0)
        x(78)=1;
        x(79)=0;
    end
    if (x(32)==x(56))&&(x(32)==1)
        x(56)=0;
        x(57)=1;
    elseif (x(32)==x(56))&&(x(32)==0)
        x(56)=1;
        x(57)=0;
    end
    if (x(7)==x(68))&&(x(7)==1)
        x(68)=0;
        x(69)=round(rand(1));
        x(70)=1-x(69);
    elseif (x(7)==x(68))&&(x(7)==0)
        x(68)=1;
        x(69)=0;
        x(70)=0;
    end
    if (x(3)==x(83))&&(x(3)==1)
        x(83)=0;
        x(80)=round(rand(1));
        x(81)=1-x(80);
        x(82)=0;
    elseif (x(3)==x(83))&&(x(3)==0)
        x(83)=1;
        x(80)=0;
        x(81)=0;
        x(82)=0;
    end
    x(end)=1;
%cost=[20;60;90;12;6;50;46;60;120;25;12;5;88;74;160;9.7;32;68;91.5;82;192;120;457;330;10;32;95;0;34;22;9.3;13;6;8;0;70;96;82;94;12;63;60;190;120;250;0;10;60;0];
%time=[4,5,7,2,3,5,4,5,8,2,1,1,4,5,8,2,3,3,5,6,8,9,2,3,4,0.0001,1,1,2,2,2,2,0.0001,22,17,18,5,2,3,1,3,2,1,0.0001,2,7,0];
%The first function 
F(i,1)=x*cost;
%The second function
nu=size(D,2);
rr=x.*time;
CC=rr(rr~=0)';
pp=repmat(CC,1,nu);
C=pp.*D;
%C=timehandle(x,A,m);
n1=size(C,2);
ST=zeros(1,n1);
  for k=2:n1
      tt=0;
      for l=1:(k-1)
          if (C(l,k)>0)&&(C(l,k))~=0.0001
              tt=[tt,C(l,k)+ST(l)];
          elseif C(l,k)==0.0001
              C(l,k)=0;
              tt=[tt,C(l,k)+ST(l)];
          end
      end
      ST(k)=max(tt);
  end
  F(i,2)=ST(n1);
%The third function
%F(i,3)=-(x*Performance-26.5234)/(56.6129-26.5234);
F(i,3)=-x*Performance;
%F(i,3)=-(x*Performance);
end
