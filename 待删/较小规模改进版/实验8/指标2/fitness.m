function F=fitness(X)
Index=[5,10,15,19,22,24,27,30,34,37,41,45,49,53,57,60,63,68,71,74,76,81,83,86,88,91,94,99,102];
D=[0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,0,1,0;0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];
time=[4,5,4,9,0.000100000000000000,2,7,9,1,6,9,11,7,1,5,3,7,3,3,6,2,8,10,10,5,7,8,6,6,1,2,5,5,3,6,7,0.000100000000000000,...
    4,5,9,0.000100000000000000,8,6,9,8,10,3,4,6,6,7,9,6,10,8,3,7,7,9,9,4,2,7,1,9,6,11,11,3,9,9,3,8,0.000100000000000000,...
    8,2,6,6,1,11,10,3,7,6,5,0.000100000000000000,7,9,2,7,6,3,2,7,10,1,5,10,6,5,3,1,0];
cost=[26;60;58;59;0;88;86;52;78;81;43;26;33;31;45;11;35;58;48;58;77;94;39;34;53;65;27;13;28;32;49;67;37;98;88;66;0;25;69;...
      74;0;80;90;67;73;88;95;42;15;38;25;44;55;81;96;36;96;27;50;26;33;12;32;45;55;37;11;89;31;30;10;33;35;0;57;82;80;94;...
      57;94;83;27;73;92;91;0;68;96;33;73;21;70;74;70;55;47;88;52;39;14;69;78;0];
Performance=[2.51936524818051;3.64733462808480;3.19844353267324;2.51091867573108;0;1.78605822995129;3.64861178733693;...
             3.75282130064337;0.265636454245371;2.14067923506897;3.04535204665570;3.66140425131259;1.99583804860797;...
             2.72211971403889;1.89272226993378;1.70040831700662;1.63111746941405;4.10313136781532;0.386829011459702;...
             0.181829800060878;3.42534113828202;1.81496925393983;4.70185169842720;0.852589946933520;2.05833016273197;...
             1.99284281083128;2.55286728354555;0.784546401299409;4.91333105889913;3.16376287240481;4.64834430705677;...
             3.19852744548421;3.17949065243780;3.00499513727937;1.23107858536793;1.43340075097853;0;3.53759904301975;...
             4.28069109037134;1.09722970633474;0;2.01729225658686;4.82855217588941;0.723138773046310;2.77736957063363;...
             3.88297127469378;0.974547105513524;1.74370253036418;1.11336717780417;2.33464208236660;4.67568948191141;...
             3.15609590848853;0.552672566300340;1.71386375917791;3.51876403714032;4.97264213757039;1.81000751924185;...
             2.59477614771345;1.11915130035507;1.73735012142074;0.664595371040257;0.922160892914015;1.49455656895881;...
             0.242907770640137;1.38899395257852;0.415548081199160;0.145734130489619;4.82311290966970;1.63198609045747;...
             3.44252879609985;1.39857680829651;2.20139660387778;4.09641366876585;0;2.63013862597338;1.76915772240415;...
             1.62602256485704;4.41536708709860;0.559775330380727;1.91406253338490;0.203798834534851;3.17087578336054;...
             4.71090307109273;2.84450223020166;1.81612848981281;0;3.51537951867195;0.737578886613917;3.60551462731445;...
             0.814760993307037;1.39681184114367;4.86089555364925;1.65582140194659;4.80567345714703;4.49601293804557;...
             0.944498061196764;0.175789921509799;1.87030067898000;3.46352730416932;4.75246089897070;1.78925945492046;...
             1.84311056295522;0];
m=Index(end);
for i = 1:size(X,1)
    idx = floor(X(i,:));
x = zeros(1,m+1);
 temp =[0,5,10,15,19,22,24,27,30,34,37,41,45,49,53,57,60,63,68,71,74,76,81,83,86,88,91,94,99];
    x(idx(idx>0)+temp) = 1;
    if (x(57)~=x(86))&&(x(57)==1)
        x(86)=1;
        x(84)=0;
        x(85)=0;
    elseif (x(57)~=x(86))&&(x(86)==1)
        x(57)=1;
        x(54)=0;
        x(55)=0;
        x(56)=0;
    end
    if (x(30)~=x(61))&&(x(30)==1)
        x(61)=1;
        x(62)=0;
        x(63)=0;
    elseif (x(30)~=x(61))&&(x(61)==1)
        x(30)=1;
        x(28)=0;
        x(29)=0;
    end
    if (x(9)~=x(83))&&(x(9)==1)
        x(83)=1;
        x(82)=0;
    elseif (x(9)~=x(83))&&(x(83)==1)
        x(9)=1;
        x(6)=0;
        x(7)=0;
        x(8)=0;
        x(10)=0;
    end
    if (x(17)==x(23))&&(x(17)==1)
        x(23)=0;
        x(24)=1;
    elseif (x(17)==x(23))&&(x(17)==0)
        x(23)=1;
        x(24)=0;
    end
    if (x(87)==x(92))&&(x(87)==1)
        x(92)=0;
        x(93)=round(rand(1));
        x(94)=1-x(93);
    elseif (x(87)==x(92))&&(x(87)==0)
        x(92)=1;
        x(93)=0;
        x(94)=0;
    end
    if (x(42)==x(64))&&(x(42)==1)
        x(64)=0;
        x(65)=round(rand(1));
        x(66)=1-x(65);
        x(67)=0;
        x(68)=0;
    elseif (x(42)==x(64))&&(x(42)==0)
        x(64)=1;
        x(65)=0;
        x(66)=0;
        x(67)=0;
        x(68)=0;
    end
    if (x(14)==x(69))&&(x(14)==1)
        x(69)=0;
        x(70)=round(rand(1));
        x(71)=1-x(70);
    elseif (x(14)==x(69))&&(x(14)==0)
        x(69)=1;
        x(70)=0;
        x(71)=0;
    end
    x(end)=1;
%cost=[20;60;90;12;6;50;46;60;120;25;12;5;88;74;160;9.7;32;68;91.5;82;192;120;457;330;10;32;95;0;34;22;9.3;13;6;8;0;70;96;82;94;12;63;60;190;120;250;0;10;60;0];
%time=[4,5,7,2,3,5,4,5,8,2,1,1,4,5,8,2,3,3,5,6,8,9,2,3,4,0.0001,1,1,2,2,2,2,0.0001,22,17,18,5,2,3,1,3,2,1,0.0001,2,7,0];
%The first function 
F(i,1)=x*cost;
%The second function
nu=size(D,2);
rr=x.*time;
CC=rr(rr~=0)';
pp=repmat(CC,1,nu);
C=pp.*D;
%C=timehandle(x,A,m);
n1=size(C,2);
ST=zeros(1,n1);
  for k=2:n1
      tt=0;
      for l=1:(k-1)
          if (C(l,k)>0)&&(C(l,k))~=0.0001
              tt=[tt,C(l,k)+ST(l)];
          elseif C(l,k)==0.0001
              C(l,k)=0;
              tt=[tt,C(l,k)+ST(l)];
          end
      end
      ST(k)=max(tt);
  end
  F(i,2)=ST(n1);
%The third function
%F(i,3)=-(x*Performance-26.5234)/(56.6129-26.5234);
F(i,3)=-x*Performance;
%F(i,3)=-(x*Performance);
end
