function F=fitness(X) 
Index=[5,8,12,14,16,20,24,27,30,34,37,41,45,49,53,58,62,65,70,74,76,80,84,88,92,96,98,103,106];
D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];
time=[4,8,7,8,10,5,4,5,8,8,5,11,6,5,8,2,5,9,9,4,3,6,4,8,3,4,9,7,10,11,9,3,7,6,5,8,9,8,2,8,2,3,10,5,2,8,3,7,4,1,11,2,6,4,...
      8,9,7,7,2,8,3,6,1,4,10,7,6,5,9,4,2,7,4,9,3,0.000100000000000000,7,1,7,8,10,9,9,6,1,9,1,7,7,2,2,7,6,4,1,7,2,1,4,4,...
      3,2,0.000100000000000000,5,3,6,0];
cost=[33;87;54;66;98;42;30;98;63;98;97;73;12;65;32;22;43;28;79;94;12;33;34;23;96;32;42;14;31;89;97;69;37;15;88;24;34;59;...
      33;86;55;54;91;92;32;12;70;34;11;19;48;21;29;77;51;20;29;94;11;68;68;71;62;81;84;68;26;75;36;86;61;18;92;52;95;0;...
      20;78;14;51;83;48;27;86;20;36;30;52;39;92;81;74;23;65;87;93;70;33;35;67;75;38;0;56;85;71;0];
Performance=[4.55050608227295;0.599698103452079;4.19866566487680;4.74134927852572;2.86810465956403;0.0207251368876177;...
             0.167561420605698;2.06233007095898;2.29138623532083;2.38825908492945;3.40710427235253;3.77445717278717;...
             4.10392359864123;1.73154576746386;3.07475057479621;1.96433673190912;3.62672826792421;2.81736319903506;....
             2.97389267897539;1.93868308656903;3.17230167976211;4.33896238217882;3.25846887921630;0.642970098810666;...
             0.443691397972678;3.38733189061172;1.77797048093837;1.57363173222899;4.45026819961796;4.31957688798027;...
             4.02831160854752;1.78661630831189;3.20390627763791;2.99416273680064;1.17771177923316;2.94848131278488;...
             4.98503316232942;0.262373184980771;1.18760216943357;1.65493383462392;4.00467095119033;2.21839720322965;...
             0.313617565271864;1.59128391882896;4.15259648285132;3.69223625939607;1.39417452527543;3.64300076502958;...
             1.59846720021376;0.762706915141783;4.92439196428111;1.30815023700123;3.04313604669565;4.58792455682266;...
             3.21495178954898;2.13389765138602;1.98607989981350;0.244532976835386;0.406233013404472;2.25340244110090;...
             4.61159674981105;1.16684726518198;4.34429618571951;4.03113503251285;0.870770127410873;1.56188731922214;...
             2.14198625107265;4.29636845106385;3.17077967895319;4.12397057461872;2.48526045150699;2.91230370120918;...
             2.26956116926129;1.29135836575209;3.09168314129611;0;4.33706644065529;4.62288297714737;2.87076125857957;...
             3.47041282396202;1.96098392481789;3.38220326719799;4.99106030332341;4.70191107425981;0.706185316724068;...
             4.69084159740256;0.193287887343648;0.125923333723485;0.888993910737446;1.52523960963892;4.92373647225657;...
             4.71730723915064;3.81977783956636;3.11545041193418;4.84441790019856;2.86508134426178;1.06609772917754;...
             0.667268809714031;3.81879712231938;2.63659152287597;4.08697300609653;3.96925527907856;0;3.88379090425156;...
             3.44072421054159;2.14382381221112;0];
m=Index(end);
for i = 1:size(X,1)
    idx = floor(X(i,:));
x = zeros(1,m+1);
temp =[0,5,8,12,14,16,20,24,27,30,34,37,41,45,49,53,58,62,65,70,74,76,80,84,88,92,96,98,103];
    x(idx(idx>0)+temp) = 1;
    if (x(13)~=x(38))&&(x(13)==1)
        x(38)=1;
        x(39)=0;
        x(40)=0;
        x(41)=0;
    elseif (x(13)~=x(38))&&(x(38)==1)
        x(13)=1;
        x(14)=0;
    end
    if (x(62)~=x(83))&&(x(62)==1)
        x(83)=1;
        x(81)=0;
        x(82)=0;
        x(84)=0;
    elseif (x(62)~=x(83))&&(x(83)==1)
        x(62)=1;
        x(59)=0;
        x(60)=0;
        x(61)=0;
    end
    if (x(88)~=x(89))&&(x(88)==1)
        x(89)=1;
        x(90)=0;
        x(91)=0;
        x(92)=0;
    elseif (x(88)~=x(89))&&(x(89)==1)
        x(88)=1;
        x(85)=0;
        x(86)=0;
        x(87)=0;
    end
    if (x(2)==x(50))&&(x(2)==1)
        x(50)=0;
        x(51)=round(rand(1));
        x(52)=1-x(51);
        x(53)=0;
    elseif (x(2)==x(50))&&(x(2)==0)
        x(50)=1;
        x(51)=0;
        x(52)=0;
        x(53)=0;
    end
    if (x(73)==x(97))&&(x(73)==1)
        x(97)=0;
        x(98)=1;
    elseif (x(73)==x(97))&&(x(73)==0)
        x(97)=1;
        x(98)=0;
    end%%
    if (x(6)==x(24))&&(x(6)==1)
        x(24)=0;
        x(21)=round(rand(1));
        x(22)=1-x(21);
        x(23)=0;
    elseif (x(6)==x(24))&&(x(6)==0)
        x(24)=1;
        x(21)=0;
        x(22)=0;
        x(23)=0;
    end
    if (x(16)==x(67))&&(x(16)==1)
        x(67)=0;
        x(66)=round(rand(1));
        x(68)=1-x(66);
        x(69)=0;
        x(70)=0;
    elseif (x(16)==x(67))&&(x(16)==0)
        x(67)=1;
        x(66)=0;
        x(68)=0;
        x(69)=0;
        x(70)=0;
    end
    x(end)=1;
%cost=[20;60;90;12;6;50;46;60;120;25;12;5;88;74;160;9.7;32;68;91.5;82;192;120;457;330;10;32;95;0;34;22;9.3;13;6;8;0;70;96;82;94;12;63;60;190;120;250;0;10;60;0];
%time=[4,5,7,2,3,5,4,5,8,2,1,1,4,5,8,2,3,3,5,6,8,9,2,3,4,0.0001,1,1,2,2,2,2,0.0001,22,17,18,5,2,3,1,3,2,1,0.0001,2,7,0];
%The first function 
F(i,1)=x*cost;
%The second function
nu=size(D,2);
rr=x.*time;
CC=rr(rr~=0)';
pp=repmat(CC,1,nu);
C=pp.*D;
%C=timehandle(x,A,m);
n1=size(C,2);
ST=zeros(1,n1);
  for k=2:n1
      tt=0;
      for l=1:(k-1)
          if (C(l,k)>0)&&(C(l,k))~=0.0001
              tt=[tt,C(l,k)+ST(l)];
          elseif C(l,k)==0.0001
              C(l,k)=0;
              tt=[tt,C(l,k)+ST(l)];
          end
      end
      ST(k)=max(tt);
  end
  F(i,2)=ST(n1);
%The third function
%F(i,3)=-(x*Performance-26.5234)/(56.6129-26.5234);
F(i,3)=-x*Performance;
%F(i,3)=-(x*Performance);
end
