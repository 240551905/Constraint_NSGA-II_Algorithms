function F=fitness(X)
Index=[3,5,9,12,15,18,21,25,28,31,35,39,41,45,48,52,57,60,65,67,71,73,76,78,80,84,87,89,92];
D=[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];
time=[7,6,6,5,9,7,3,8,11,6,10,4,7,5,5,9,6,0.000100000000000000,6,2,5,10,5,1,3,2,11,11,9,7,9,3,4,6,5,1,11,5,6,4,4,5,9,...
      8,0.000100000000000000,1,9,4,7,1,8,5,6,5,5,7,11,2,4,1,8,8,3,5,7,8,3,10,9,2,10,8,9,6,3,10,7,4,4,10,5,6,7,9,7,3,7,...
      6,6,8,3,3,0];
cost=[20;35;11;67;37;27;19;36;29;36;52;59;86;99;14;31;68;0;88;30;77;69;82;13;31;73;18;13;42;63;15;16;14;46;70;28;89;...
      49;66;36;65;96;50;29;0;50;56;57;14;25;51;74;80;80;55;96;40;53;77;87;47;86;50;74;11;12;95;19;70;35;28;45;93;61;93;...
      73;55;56;30;10;48;61;89;71;86;93;95;83;22;41;29;88;0];
Performance=[3.96165109653129;1.74500820341930;2.84570266027818;4.02565770127851;4.16580622366988;1.02896838475036;...
             3.65340100263058;4.01707082079725;0.215645181766814;0.535937021157900;2.17541824929414;1.10440610930372;...
             4.40311033082840;3.59843768862206;3.56503646773491;3.84929828496351;1.65373513084702;0;3.13171979600513;...
             2.07239624762695;4.68390536117093;3.21226209451396;1.93450171506184;4.27559830402095;1.90396291858104;...
             0.891549138888601;3.90829712833041;2.36104293707901;1.29740202202139;3.46199622940616;4.90242539499389;...
             1.23126794483895;3.95121901297023;3.81167622112029;0.600198960887070;4.19451297279500;2.30869452378266;...
             0.628906912765438;2.68171736548034;1.48256375397315;0.878620966283653;0.396190853503998;0.994495459147496;...
             2.14794309528207;0;0.436895893948982;3.57865293885483;0.508724054816910;0.877995354544109;3.56660781078705;...
             4.42631837205245;4.91569180521536;3.26453475350607;2.38868176503188;0.438937774424972;2.79475397348638;...
             0.905751147043232;2.57201030235610;3.04465074467196;4.16606245061302;1.61875291128073;4.94431046659853;...
             4.97475129983897;4.13075409719898;3.47076272712592;3.66834899048488;4.37634404902331;4.75755074172866;...
             4.26131463298776;3.20469319889432;0.367491923572183;3.11692357147919;1.76606945892759;0.823893116121482;...
             4.46583093283522;4.12445240603340;2.63319211926417;2.31724628076786;2.44650644063563;1.30360009859726;...
             2.01318961566574;2.18334939863515;0.0752806712418502;4.46452941539358;0.145746589237559;1.86446442005863;...
             0.479366573463861;0.984821601750193;4.71210306198572;1.85635585833948;3.64500400910738;0.630800543145108;0];
m=Index(end);
for i = 1:size(X,1)
    idx = floor(X(i,:));
x = zeros(1,m+1);
%temp = [0,3,5,7,9,12,15,18,24,27,31,33,36,39,41,43];
temp = [0,3,5,9,12,15,18,21,25,28,31,35,39,41,45,48,52,57,60,65,67,71,73,76,78,80,84,87,89];
    x(idx(idx>0)+temp) = 1;
    if (x(27)~=x(64))&&(x(27)==1)
        x(64)=1;
        x(61)=0;
        x(62)=0;
        x(63)=0;
        x(65)=0;
    elseif (x(27)~=x(64))&&(x(64)==1)
        x(27)=1;
        x(26)=0;
        x(28)=0;
    end
    if (x(68)~=x(88))&&(x(68)==1)
        x(88)=1;
        x(89)=0;
    elseif (x(68)~=x(88))&&(x(88)==1)
        x(68)=1;
        x(69)=0;
        x(70)=0;
        x(71)=0;
    end
    if (x(34)~=x(77))&&(x(34)==1)
        x(77)=1;
        x(78)=0;
    elseif (x(34)~=x(77))&&(x(77)==1)
        x(34)=1;
        x(32)=0;
        x(33)=0;
        x(35)=0;
    end
    if (x(57)==x(73))&&(x(57)==1)
        x(73)=0;
        x(72)=1;
    elseif (x(57)==x(73))&&(x(57)==0)
        x(73)=1;
        x(72)=0;
    end
    if (x(13)==x(40))&&(x(13)==1)
        x(40)=0;
        x(41)=1;
    elseif (x(13)==x(40))&&(x(13)==0)
         x(40)=1;
        x(41)=0;
    end
    if (x(17)==x(48))&&(x(17)==1)
        x(48)=0;
        x(46)=round(rand(1));
        x(47)=1-x(46);
    elseif (x(17)==x(48))&&(x(17)==0)
        x(48)=1;
        x(46)=0;
        x(47)=0;
    end
    if (x(45)==x(79))&&(x(45)==1)
        x(79)=0;
        x(80)=1;
    elseif (x(45)==x(79))&&(x(45)==0)
        x(79)=1;
        x(80)=0;
    end
    if (x(50)==x(60))&&(x(50)==1)
        x(60)=0;
        x(58)=round(rand(1));
        x(59)=1-x(58);
    elseif (x(50)==x(60))&&(x(50)==0)
        x(60)=1;
        x(58)=0;
        x(59)=0;
    end
    x(end)=1;
%cost=[20;60;90;12;6;50;46;60;120;25;12;5;88;74;160;9.7;32;68;91.5;82;192;120;457;330;10;32;95;0;34;22;9.3;13;6;8;0;70;96;82;94;12;63;60;190;120;250;0;10;60;0];
%time=[4,5,7,2,3,5,4,5,8,2,1,1,4,5,8,2,3,3,5,6,8,9,2,3,4,0.0001,1,1,2,2,2,2,0.0001,22,17,18,5,2,3,1,3,2,1,0.0001,2,7,0];
%The first function 
F(i,1)=x*cost;
%The second function
nu=size(D,2);
rr=x.*time;
CC=rr(rr~=0)';
pp=repmat(CC,1,nu);
C=pp.*D;
%C=timehandle(x,A,m);
n1=size(C,2);
ST=zeros(1,n1);
  for k=2:n1
      tt=0;
      for l=1:(k-1)
          if (C(l,k)>0)&&(C(l,k))~=0.0001
              tt=[tt,C(l,k)+ST(l)];
          elseif C(l,k)==0.0001
              C(l,k)=0;
              tt=[tt,C(l,k)+ST(l)];
          end
      end
      ST(k)=max(tt);
  end
  F(i,2)=ST(n1);
%The third function
%F(i,3)=-(x*Performance-26.5234)/(56.6129-26.5234);
F(i,3)=-x*Performance;
%F(i,3)=-(x*Performance);
end
