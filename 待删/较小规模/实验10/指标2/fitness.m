function F=fitness(X) 
Index=[4,6,10,14,17,20,23,27,30,32,36,41,43,47,51,55,59,62,67,71,75,77,80,84,87,90,94,98,102];
D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,1,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,1,0,0;...
   0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0;...
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1];
time=[2,4,2,9,1,7,6,9,3,10,5,9,4,10,4,3,5,2,9,3,5,10,11,6,9,4,7,10,6,0.000100000000000000,1,5,2,4,4,9,1,5,4,7,4,1,10,9,10,...
      5,7,6,7,4,0.000100000000000000,1,4,3,7,7,6,4,2,11,4,6,11,5,4,6,7,10,2,6,9,8,7,1,5,7,4,6,8,3,2,4,2,0.000100000000000000,...
      10,5,0.000100000000000000,9,2,8,6,7,2,3,7,1,3,6,3,5,10,10,0];
cost=[61;58;11;98;62;81;61;89;63;74;23;49;72;19;50;25;56;84;18;82;61;63;28;49;37;13;13;51;77;0;45;25;85;64;80;86;64;80;65;...
      12;78;26;51;56;54;86;26;11;86;77;0;48;21;40;19;74;17;29;62;36;69;82;42;18;83;81;45;88;45;33;85;76;56;68;29;91;97;39;...
      88;38;12;14;27;0;33;92;0;22;83;46;12;87;35;74;42;81;86;58;60;21;44;49;0];
Performance=[2.55604323142733;4.45881284967847;1.50105305797007;1.98220939439225;3.96636616513807;2.06138038676700;...
             0.924337749954562;4.20123658044195;2.84635699850644;0.300251027754098;4.94458487098101;1.14391166600983;...
             3.07350856490085;1.84013340417730;4.01387968174123;3.13780926352814;4.10608238099130;1.44126569396108;...
             1.37397565796384;3.00525945566255;4.69257098604669;3.53648154670719;1.31701582478379;0.611679605575025;...
             2.29362114594932;4.87406249698335;3.40287187222222;0.966268661432305;0.233696135806975;0;4.29324507734213;...
             4.13951587874286;4.81950261419141;2.99468224536337;4.65457917923876;0.733844071393634;0.569801543773461;...
             1.86014451086917;3.83280063285453;1.60571015732480;3.19017540672313;0.0461055083493944;2.71732519237458;...
             1.68877323442592;4.49012154424758;4.70353519241612;1.92060924576785;1.98058896170298;4.48639972409674;...
             0.294111840509235;0;0.650877703154562;0.434847044623088;3.91982143479494;1.52286677673310;2.92027936277635;...
             4.39233089213332;4.40396030306770;3.00477103622838;3.22613872842017;0.283141014190531;1.48742048487961;...
             3.45887303788233;0.945147264278177;4.01503768358449;2.57381874928356;3.78643020157807;0.888943743085490;...
             0.413101456477464;2.41035984861429;2.64426939681063;3.48154135904499;1.02380807015098;3.35686164978682;...
             3.96634662663210;0.208689062584805;4.81678752860745;4.87696358586666;2.75330392110908;0.324534912033048;...
             1.72618394930929;0.102149844057476;4.00425904891808;0;0.716262554525910;3.49946992264626;0;1.28303783424498;...
             2.55165892274423;4.97629392410128;0.732578396584008;2.24757388799338;3.00720188091403;0.486362470699401;...
             1.44367440270988;3.60399950953704;2.75403032020474;4.19288507526944;2.90165675733988;0.922858683048131;...
             3.07751058529270;4.43477544234305;0];
m=Index(end);
for i = 1:size(X,1)
    idx = floor(X(i,:));
x = zeros(1,m+1);
temp =[0,4,6,10,14,17,20,23,27,30,32,36,41,43,47,51,55,59,62,67,71,75,77,80,84,87,90,94,98];
    x(idx(idx>0)+temp) = 1;
    if (x(12)~=x(76))&&(x(12)==1)
        x(76)=1;
        x(77)=0;
    elseif (x(12)~=x(76))&&(x(76)==1)
        x(12)=1;
        x(11)=0;
        x(13)=0;
        x(14)=0;
    end
    if (x(20)~=x(101))&&(x(20)==1)
        x(101)=1;
        x(99)=0;
        x(100)=0;
        x(102)=0;
    elseif (x(20)~=x(101))&&(x(101)==1)
        x(20)=1;
        x(18)=0;
        x(19)=0;
    end
    if (x(80)~=x(87))&&(x(80)==1)
        x(87)=1;
        x(85)=0;
        x(86)=0;
    elseif (x(80)~=x(87))&&(x(87)==1)
        x(80)=1;
        x(78)=0;
        x(79)=0;
    end
    if (x(15)==x(42))&&(x(15)==1)
        x(42)=0;
        x(43)=1;
    elseif (x(15)==x(42))&&(x(15)==0)
        x(42)=1;
        x(43)=0;
    end
    if (x(25)==x(59))&&(x(25)==1)
        x(59)=0;
        x(56)=round(rand(1));
        x(57)=1-x(56);
        x(58)=0;
    elseif (x(25)==x(59))&&(x(25)==0)
        x(59)=1;
        x(56)=0;
        x(57)=0;
        x(58)=0;
    end
    if (x(30)==x(64))&&(x(30)==1)
        x(64)=0;
        x(63)=round(rand(1));
        x(65)=1-x(63);
        x(66)=0;
        x(67)=0;
    elseif (x(30)==x(64))&&(x(30)==0)
        x(64)=1;
        x(63)=0;
        x(65)=0;
        x(66)=0;
        x(67)=0;
    end
    if (x(75)==x(84))&&(x(75)==1)
        x(84)=0;
        x(81)=round(rand(1));
        x(82)=1-x(81);
        x(83)=0;
    elseif (x(75)==x(84))&&(x(75)==0)
        x(84)=1;
        x(81)=0;
        x(82)=0;
        x(83)=0;
    end
    if (x(92)==x(95))&&(x(92)==1)
        x(95)=0;
        x(96)=round(rand(1));
        x(97)=1-x(96);
        x(98)=0;
    elseif (x(92)==x(95))&&(x(92)==0)
        x(95)=1;
        x(96)=0;
        x(97)=0;
        x(98)=0;
    end
    x(end)=1;
%cost=[20;60;90;12;6;50;46;60;120;25;12;5;88;74;160;9.7;32;68;91.5;82;192;120;457;330;10;32;95;0;34;22;9.3;13;6;8;0;70;96;82;94;12;63;60;190;120;250;0;10;60;0];
%time=[4,5,7,2,3,5,4,5,8,2,1,1,4,5,8,2,3,3,5,6,8,9,2,3,4,0.0001,1,1,2,2,2,2,0.0001,22,17,18,5,2,3,1,3,2,1,0.0001,2,7,0];
%The first function 
F(i,1)=x*cost;
%The second function
nu=size(D,2);
rr=x.*time;
CC=rr(rr~=0)';
pp=repmat(CC,1,nu);
C=pp.*D;
%C=timehandle(x,A,m);
n1=size(C,2);
ST=zeros(1,n1);
  for k=2:n1
      tt=0;
      for l=1:(k-1)
          if (C(l,k)>0)&&(C(l,k))~=0.0001
              tt=[tt,C(l,k)+ST(l)];
          elseif C(l,k)==0.0001
              C(l,k)=0;
              tt=[tt,C(l,k)+ST(l)];
          end
      end
      ST(k)=max(tt);
  end
  F(i,2)=ST(n1);
%The third function
%F(i,3)=-(x*Performance-26.5234)/(56.6129-26.5234);
F(i,3)=-x*Performance;
%F(i,3)=-(x*Performance);
end
